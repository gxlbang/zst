@model LeaRun.Entity.Am_Ammeter
@{
    ViewBag.Title = "关联用户";
    Layout = "~/Views/Shared/_Partial.cshtml";
}

@if (Model != null && Model.Number != null)
{
    //关联用户
    LeaRun.Entity.Am_AmmeterPermission ammeterPermission = new LeaRun.Entity.Am_AmmeterPermission();
    if (ViewBag.ammeterPermission != null)
    {
        ammeterPermission = ViewBag.ammeterPermission as LeaRun.Entity.Am_AmmeterPermission;
    }
    //模板
    LeaRun.Entity.Am_Template template = new LeaRun.Entity.Am_Template();
    if (ViewBag.template != null)
    {
        template = ViewBag.template as LeaRun.Entity.Am_Template;
    }
    //模板收费项
    List<LeaRun.Entity.Am_TemplateContent> templateContentList = new List<LeaRun.Entity.Am_TemplateContent>();
    if (ViewBag.templateContentList != null)
    {
        templateContentList = ViewBag.templateContentList as List<LeaRun.Entity.Am_TemplateContent>;
    }
    //系统预设收费项
    List<LeaRun.Entity.Am_ChargeItem> chargeItemList = new List<LeaRun.Entity.Am_ChargeItem>();
    if (ViewBag.chargeItemList != null)
    {
        chargeItemList = ViewBag.chargeItemList as List<LeaRun.Entity.Am_ChargeItem>;
    }



    <div class="all">
        <header class="header clear">
            <a href="javascript:history.go(-1);" class="return fl"></a>
            <h1 class="title">关联用户</h1>
        </header>

        <div class="charge-top bbot">
            <span class="charge-span">表号：@Model.AM_Code</span>
            <span class="charge-span">区域：@Model.Province@Model.City@Model.County</span>
            <span class="charge-span">地址：@Model.Address @Model.Cell 单元 @Model.Floor 层 @Model.Room 号</span>
        </div>
        <div class="gary charge-bill binding-text bbot clear"><span class="bill-text fl">关联用户</span></div>
        <div class="charge-bill binding-text bbot clear">
            <span class="bill-text fl">手机号：</span>
            <input type="text" class="l-input fl" maxlength="11" value="@ammeterPermission.UserName" placeholder="输入手机号" />
        </div>
        <div class="charge-bill binding-text bbot clear">
            <span class="bill-text fl">姓名：</span>
            <input type="text" class="l-input fl" maxlength="11" value="@ammeterPermission.U_Name" placeholder="输入姓名" />
        </div>
        <div class="charge-bill binding-text bbot clear">
            <span class="bill-text fl">租赁时间：</span>
            <input type="date" class="l-input fl" maxlength="" value="@ammeterPermission.CreateTime.Value.ToString("yyyy-MM-dd")" placeholder="2018-01-01" />
        </div>
        <div class="charge-bill binding-text bbot clear">
            <span class="bill-text fl">到期时间：</span>
            <input type="date" class="l-input fl" maxlength="" value="@ammeterPermission.LeaveTime.Value.ToString("yyyy-MM-dd")" placeholder="2018-01-01" />
        </div>
        <div class="charge-bill binding-text bbot clear">
            <span class="bill-text fl">账单周期：</span>
            <select class="charge-se">
                <option>1个月</option>
                <option>2个月</option>
                <option>3个月</option>
                <option>4个月</option>
                <option>5个月</option>
                <option>6个月</option>
                <option>7个月</option>
                <option>8个月</option>
                <option>9个月</option>
                <option>10个月</option>
                <option>11个月</option>
                <option>12个月</option>

            </select>
        </div>
        <div class="charge-bill binding-text bbot clear">
            <span class="bill-text fl">滞纳金：</span>
            <input type="text" class="l-input fl" maxlength="11" value="@template.OtherFees" placeholder="%" />
        </div>
        <div class="gary"></div>
        <div class="acc-top bbot btop clear">
            <span class="acc-one fl">项目</span>
            <span class="acc-one acc-two fl">金额</span>
        </div>
        <div class="acc-all">
            @if (templateContentList != null && templateContentList.Count() > 0)
            {
                foreach (var item in templateContentList)
                {
                    <div class="acc-top acc-pa clear">
                        <span class="acc-one fl"><input type="text" class="acc-in" placeholder="租金" value="@item.ChargeItem_Title" /></span>
                        <span class="acc-one acc-two fl"><input type="text" class="acc-in" placeholder="0.00" value="@item.Money.Value.ToString("0.00")" /></span>
                        @if (chargeItemList.Select(o => o.Title == item.ChargeItem_Title).Count() > 0)
                        {
                            <input class="icon-close fr" type="button" onclick="test(this)" value="-" />
                        }

                    </div>
                }
            }
            else
            {
                foreach (var item in chargeItemList)
                {
                    <div class="acc-top acc-pa clear">
                        <span class="acc-one fl"><input type="text" class="acc-in" placeholder="租金" value="@item.Title" /></span>
                        <span class="acc-one acc-two fl"><input type="text" class="acc-in" placeholder="0.00" value="@item.Money.Value.ToString("0.00")" /></span>
                    </div>
                }

            }
            <div id="container"></div>
            <div class="acc-add"><button id="add" class="acc-aj">+增加收费项</button></div>

        </div>
        <div class="acc-btnt clear">
            <a href="" class="acc-btno fl">保存</a>
            <a href="" class="acc-btno acc-btntt fr">取消</a>
        </div>
    </div>
}



<script type="text/javascript">
    var add = document.getElementById('add');
    var container = document.getElementById('container');
    var node = container.nextSibling;
    add.onclick = function () {
        oDiv = document.createElement('div');
        oDiv.innerHTML = "<div class='acc-top acc-pa clear'><span class='acc-one fl'><input type='text' class='acc-in' placeholder='公摊费' /></span><span class='acc-one acc-two fl'><input type='text' class='acc-in' placeholder='0.00' /></span><input class='icon-close fr' type='button' onclick='test(this)' value='-' /></div>";
        container.parentNode.insertBefore(oDiv, node)
        node = oDiv.nextSibling;

    }
    function test(test) {
        test.parentNode.parentNode.removeChild(test.parentNode);
    }
</script>
